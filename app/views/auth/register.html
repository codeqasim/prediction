<!-- Authentication View - Register Mode -->
<div class="flex items-center justify-center min-h-screen py-8 px-4 sm:px-6 lg:px-8 relative z-10" ng-controller="AuthController as auth" ng-init="auth.currentMode = 'register'">
    <div class="max-w-md w-full space-y-8">

        <!-- Auth Container -->
        <div class="bg-white/5 backdrop-blur-2xl border border-white/10 rounded-3xl shadow-2xl p-6">

            <!-- Header -->
            <div class="text-center mb-6">
                <h2 class="text-xl font-bold text-white mb-1">
                    {{auth.currentMode === 'login' ? 'Welcome Back' : 'Create Account'}}
                </h2>
                <p class="text-slate-400 text-sm">
                    {{auth.currentMode === 'login' ? 'Sign in to continue predicting the future' : 'Join to start predicting the future'}}
                </p>
            </div>

            <!-- Mode Toggle -->
            <div class="flex bg-white/5 border border-white/10 rounded-2xl p-1 mb-6">
                <button ng-click="auth.switchMode('login')"
                        ng-class="{'bg-white text-dark-900 shadow-lg': auth.currentMode === 'login', 'text-slate-400 hover:text-white hover:bg-white/10': auth.currentMode !== 'login'}"
                        class="flex-1 py-2.5 text-center rounded-xl text-sm font-medium transition-all duration-300">
                    <span class="material-icons-outlined text-sm mr-1.5 inline-block">login</span>Login
                </button>
                <button ng-click="auth.switchMode('register')"
                        ng-class="{'bg-white text-dark-900 shadow-lg': auth.currentMode === 'register', 'text-slate-400 hover:text-white hover:bg-white/10': auth.currentMode !== 'register'}"
                        class="flex-1 py-2.5 text-center rounded-xl text-sm font-medium transition-all duration-300">
                    <span class="material-icons-outlined text-sm mr-1.5 inline-block">person_add</span>Sign Up
                </button>
            </div>

            <!-- Login Form -->
            <form ng-show="auth.currentMode === 'login'" ng-submit="auth.login()" class="space-y-4">

                <!-- Email Input -->
                <div>
                    <label for="loginEmail" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">email</span>Email Address
                    </label>
                    <input id="loginEmail"
                           ng-model="auth.loginForm.email"
                           type="email"
                           required
                           ng-focus="auth.clearErrors()"
                           ng-class="{'border-red-500': auth.errors.email, 'border-white/20': !auth.errors.email}"
                           class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                           placeholder="Enter your email">
                    <div ng-show="auth.errors.email" class="text-red-400 text-xs mt-1">{{auth.errors.email}}</div>
                </div>

                <!-- Password Input -->
                <div>
                    <label for="loginPassword" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">lock</span>Password
                    </label>
                    <div class="relative">
                        <input id="loginPassword"
                               ng-model="auth.loginForm.password"
                               ng-type="auth.showPassword ? 'text' : 'password'"
                               required
                               ng-focus="auth.clearErrors()"
                               ng-class="{'border-red-500': auth.errors.password, 'border-white/20': !auth.errors.password}"
                               class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 pr-12 placeholder-slate-400"
                               placeholder="Enter your password">
                        <button type="button"
                                ng-click="auth.showPassword = !auth.showPassword"
                                class="absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors">
                            <span class="material-icons-outlined">{{auth.showPassword ? 'visibility_off' : 'visibility'}}</span>
                        </button>
                    </div>
                    <div ng-show="auth.errors.password" class="text-red-400 text-xs mt-1">{{auth.errors.password}}</div>
                </div>

                <!-- Remember & Forgot -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input id="rememberMe"
                               ng-model="auth.loginForm.rememberMe"
                               type="checkbox"
                               class="h-4 w-4 text-white focus:ring-white/50 border-white/20 bg-white/5 rounded">
                        <label for="rememberMe" class="ml-3 block text-sm text-slate-300">
                            Remember me
                        </label>
                    </div>
                    <a ng-click="auth.showResetModal = true"
                       class="text-sm text-white hover:text-slate-300 transition-colors font-medium cursor-pointer">
                        Forgot password?
                    </a>
                </div>

                <!-- General Error -->
                <div ng-show="auth.errors.general" class="text-red-400 text-sm text-center p-3 bg-red-500/10 border border-red-500/20 rounded-xl">
                    {{auth.errors.general}}
                </div>

                <!-- Login Button -->
                <div>
                    <button type="submit"
                            ng-disabled="auth.isLoading"
                            class="w-full bg-white hover:bg-slate-100 text-dark-900 py-2.5 px-4 rounded-xl text-sm font-medium focus:ring-2 focus:ring-white/50 focus:ring-offset-2 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]">
                        <span ng-hide="auth.isLoading" class="flex items-center justify-center">
                            <span class="material-icons-outlined mr-2">login</span>Sign In
                        </span>
                        <span ng-show="auth.isLoading" class="flex items-center justify-center">
                            <span class="material-icons-outlined animate-spin mr-2">refresh</span>Signing In...
                        </span>
                    </button>
                </div>
            </form>

            <!-- Register Form -->
            <form ng-show="auth.currentMode === 'register'" ng-submit="auth.register()" class="space-y-4">

                <!-- First Name & Last Name -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="firstName" class="block text-sm font-medium text-slate-300 mb-2">
                            <span class="material-icons-outlined text-sm mr-2 inline-block">badge</span>First Name
                        </label>
                        <input id="firstName"
                               ng-model="auth.registerForm.firstName"
                               type="text"
                               required
                               ng-focus="auth.clearErrors()"
                               ng-class="{'border-red-500': auth.errors.firstName, 'border-white/20': !auth.errors.firstName}"
                               class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                               placeholder="John">
                        <div ng-show="auth.errors.firstName" class="text-red-400 text-xs mt-1">{{auth.errors.firstName}}</div>
                    </div>
                    <div>
                        <label for="lastName" class="block text-sm font-medium text-slate-300 mb-2">
                            <span class="material-icons-outlined text-sm mr-2 inline-block">badge</span>Last Name
                        </label>
                        <input id="lastName"
                               ng-model="auth.registerForm.lastName"
                               type="text"
                               required
                               ng-focus="auth.clearErrors()"
                               ng-class="{'border-red-500': auth.errors.lastName, 'border-white/20': !auth.errors.lastName}"
                               class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                               placeholder="Doe">
                        <div ng-show="auth.errors.lastName" class="text-red-400 text-xs mt-1">{{auth.errors.lastName}}</div>
                    </div>
                </div>

                <!-- Username -->
                <div>
                    <label for="signupUsername" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">person</span>Username
                    </label>
                    <input id="signupUsername"
                           ng-model="auth.registerForm.username"
                           type="text"
                           required
                           ng-focus="auth.clearErrors()"
                           ng-blur="auth.checkUsernameAvailability()"
                           ng-class="{'border-red-500': auth.errors.username, 'border-white/20': !auth.errors.username}"
                           class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                           placeholder="Choose a username">
                    <p class="text-xs text-slate-400 mt-2">This will be your public display name</p>
                    <div ng-show="auth.errors.username" class="text-red-400 text-xs mt-1">{{auth.errors.username}}</div>
                </div>

                <!-- Email -->
                <div>
                    <label for="signupEmail" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">email</span>Email Address
                    </label>
                    <input id="signupEmail"
                           ng-model="auth.registerForm.email"
                           type="email"
                           required
                           ng-focus="auth.clearErrors()"
                           ng-class="{'border-red-500': auth.errors.email, 'border-white/20': !auth.errors.email}"
                           class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                           placeholder="Enter your email">
                    <div ng-show="auth.errors.email" class="text-red-400 text-xs mt-1">{{auth.errors.email}}</div>
                </div>

                <!-- Password -->
                <div>
                    <label for="signupPassword" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">lock</span>Password
                    </label>
                    <div class="relative">
                        <input id="signupPassword"
                               ng-model="auth.registerForm.password"
                               ng-type="auth.showPassword ? 'text' : 'password'"
                               required
                               ng-focus="auth.clearErrors()"
                               ng-keyup="auth.checkPasswordStrength()"
                               ng-class="{'border-red-500': auth.errors.password, 'border-white/20': !auth.errors.password}"
                               class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 pr-12 placeholder-slate-400"
                               placeholder="Create a strong password">
                        <button type="button"
                                ng-click="auth.showPassword = !auth.showPassword"
                                class="absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors">
                            <span class="material-icons-outlined">{{auth.showPassword ? 'visibility_off' : 'visibility'}}</span>
                        </button>
                    </div>

                    <!-- Password Strength Indicator -->
                    <div ng-show="auth.passwordStrength.visible" class="mt-2">
                        <div class="flex space-x-1">
                            <div ng-repeat="i in [1,2,3,4,5] track by $index"
                                 ng-class="{'bg-emerald-500': $index < auth.passwordStrength.score && auth.passwordStrength.score >= 4, 'bg-yellow-500': $index < auth.passwordStrength.score && auth.passwordStrength.score >= 2 && auth.passwordStrength.score < 4, 'bg-red-500': $index < auth.passwordStrength.score && auth.passwordStrength.score < 2, 'bg-white/10': $index >= auth.passwordStrength.score}"
                                 class="h-1 flex-1 rounded"></div>
                        </div>
                        <p class="text-xs mt-2 text-slate-400">Password strength: {{auth.passwordStrength.feedback}}</p>
                    </div>
                    <div ng-show="auth.errors.password" class="text-red-400 text-xs mt-1">{{auth.errors.password}}</div>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label for="confirmPassword" class="block text-sm font-medium text-slate-300 mb-2">
                        <span class="material-icons-outlined text-sm mr-2 inline-block">lock_open</span>Confirm Password
                    </label>
                    <input id="confirmPassword"
                           ng-model="auth.registerForm.confirmPassword"
                           ng-type="auth.showConfirmPassword ? 'text' : 'password'"
                           required
                           ng-focus="auth.clearErrors()"
                           ng-class="{'border-red-500': auth.errors.confirmPassword, 'border-white/20': !auth.errors.confirmPassword}"
                           class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                           placeholder="Confirm your password">
                    <div ng-show="auth.errors.confirmPassword" class="text-red-400 text-xs mt-1">{{auth.errors.confirmPassword}}</div>
                </div>

                <!-- Terms Checkbox -->
                <div class="flex items-start">
                    <input id="agreeTerms"
                           ng-model="auth.registerForm.agreeTerms"
                           type="checkbox"
                           required
                           ng-focus="auth.clearErrors()"
                           class="h-4 w-4 text-white focus:ring-white/50 border-white/20 bg-white/5 rounded mt-0.5">
                    <label for="agreeTerms" class="ml-3 block text-sm text-slate-300">
                        I agree to the <a href="/terms" class="text-white hover:text-slate-300 transition-colors underline">Terms of Service</a>
                        and <a href="/privacy" class="text-white hover:text-slate-300 transition-colors underline">Privacy Policy</a>
                    </label>
                </div>
                <div ng-show="auth.errors.agreeTerms" class="text-red-400 text-xs">{{auth.errors.agreeTerms}}</div>

                <!-- General Error -->
                <div ng-show="auth.errors.general" class="text-red-400 text-sm text-center p-3 bg-red-500/10 border border-red-500/20 rounded-xl">
                    {{auth.errors.general}}
                </div>

                <!-- Register Button -->
                <div>
                    <button type="submit"
                            ng-disabled="auth.isLoading"
                            class="w-full bg-white hover:bg-slate-100 text-dark-900 py-2.5 px-4 rounded-xl text-sm font-medium focus:ring-2 focus:ring-white/50 focus:ring-offset-2 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]">
                        <span ng-hide="auth.isLoading" class="flex items-center justify-center">
                            <span class="material-icons-outlined mr-2">person_add</span>Create Account
                        </span>
                        <span ng-show="auth.isLoading" class="flex items-center justify-center">
                            <span class="material-icons-outlined animate-spin mr-2">refresh</span>Creating Account...
                        </span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Additional Info -->
        <div class="text-center mt-6">
            <p class="text-sm text-slate-400">
                New to PredictIt?
                <span class="text-white font-medium">Get 100 free points</span>
                when you join!
            </p>
        </div>
    </div>

    <!-- Password Reset Modal -->
    <div ng-show="auth.showResetModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 p-4">
        <div class="flex items-center justify-center min-h-full">
            <div class="bg-white/10 backdrop-blur-2xl border border-white/20 rounded-3xl max-w-md w-full p-6">
                <div class="text-center mb-6">
                    <span class="material-icons-outlined text-white text-3xl mb-3 block">vpn_key</span>
                    <h3 class="text-lg font-bold text-white mb-2">Reset Password</h3>
                    <p class="text-slate-400 text-sm">Enter your email to receive reset instructions</p>
                </div>

                <form ng-submit="auth.resetPassword()">
                    <div class="mb-6">
                        <label for="resetEmail" class="block text-sm font-medium text-slate-300 mb-2">
                            <span class="material-icons-outlined text-sm mr-2 inline-block">email</span>Email Address
                        </label>
                        <input id="resetEmail"
                               ng-model="auth.resetForm.email"
                               type="email"
                               required
                               ng-focus="auth.clearErrors()"
                               ng-class="{'border-red-500': auth.errors.resetEmail, 'border-white/20': !auth.errors.resetEmail}"
                               class="w-full px-4 py-2.5 bg-white/5 backdrop-blur-sm border text-white rounded-xl focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 placeholder-slate-400"
                               placeholder="Enter your email">
                        <div ng-show="auth.errors.resetEmail" class="text-red-400 text-xs mt-1">{{auth.errors.resetEmail}}</div>
                    </div>

                    <div class="flex space-x-3">
                        <button type="button"
                                ng-click="auth.showResetModal = false"
                                class="flex-1 bg-white/10 text-slate-300 py-2.5 px-4 rounded-xl text-sm font-medium hover:bg-white/20 hover:text-white transition-all duration-300">
                            Cancel
                        </button>
                        <button type="submit"
                                ng-disabled="auth.isLoading"
                                class="flex-1 bg-white text-dark-900 py-2.5 px-4 rounded-xl text-sm font-medium hover:bg-slate-100 transition-all duration-300">
                            <span ng-hide="auth.isLoading">Send Reset Link</span>
                            <span ng-show="auth.isLoading" class="flex items-center justify-center">
                                <span class="material-icons-outlined animate-spin mr-1">refresh</span>Sending...
                            </span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
