<!-- Enhanced Header Component -->
<header class="sticky top-0 z-50 backdrop-blur-lg bg-black/70 border-b border-purple-500/20" ng-controller="HeaderController as header">
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
        <div class="flex items-center justify-between">

            <!-- Enhanced Logo -->
            <div class="flex items-center">
                <a ng-click="header.navigateTo('/')" class="cursor-pointer flex items-center space-x-3 group">
                    <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-300">
                        <span class="material-icons-outlined text-white text-lg">auto_awesome</span>
                    </div>
                    <span class="text-lg font-bold bg-gradient-to-r from-white to-purple-300 bg-clip-text text-transparent group-hover:from-purple-200 group-hover:to-purple-100 transition-all duration-300">
                        Prediction
                    </span>
                </a>
            </div>

            <!-- Compact Desktop Navigation -->
            <nav class="hidden md:flex items-center space-x-1">
                <a ng-click="header.navigateTo('/')"
                   ng-class="{'bg-purple-500/20 text-white border-purple-500/30': header.isActive('/'), 'text-slate-400 hover:text-white hover:bg-purple-500/10 border-transparent': !header.isActive('/')}"
                   class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300 cursor-pointer flex items-center border">
                    <span class="material-icons-outlined text-sm mr-2">home</span>Home
                </a>

                <a ng-click="header.navigateTo('/predictions')"
                   ng-class="{'bg-purple-500/20 text-white border-purple-500/30': header.isActive('/predictions'), 'text-slate-400 hover:text-white hover:bg-purple-500/10 border-transparent': !header.isActive('/predictions')}"
                   class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300 cursor-pointer flex items-center border">
                    <span class="material-icons-outlined text-sm mr-2">psychology</span>Predictions
                </a>

                <a ng-click="header.navigateTo('/leaderboard')"
                   ng-class="{'bg-purple-500/20 text-white border-purple-500/30': header.isActive('/leaderboard'), 'text-slate-400 hover:text-white hover:bg-purple-500/10 border-transparent': !header.isActive('/leaderboard')}"
                   class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300 cursor-pointer flex items-center border">
                    <span class="material-icons-outlined text-sm mr-2">emoji_events</span>Leaderboard
                </a>

                <a ng-click="header.navigateTo('/about')"
                   ng-class="{'bg-purple-500/20 text-white border-purple-500/30': header.isActive('/about'), 'text-slate-400 hover:text-white hover:bg-purple-500/10 border-transparent': !header.isActive('/about')}"
                   class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300 cursor-pointer flex items-center border">
                    <span class="material-icons-outlined text-sm mr-2">info</span>About
                </a>
            </nav>

            <!-- Enhanced User Section -->
            <div class="flex items-center space-x-3">

                <!-- Authenticated User -->
                <div ng-if="header.isAuthenticated()" class="flex items-center space-x-3">&

                    <!-- User Points -->
                    <div class="hidden sm:flex items-center bg-gradient-to-r from-purple-500/20 to-violet-500/20 backdrop-blur-sm border border-purple-500/30 rounded-lg px-3 py-1.5">
                        <span class="material-icons-outlined text-purple-300 text-sm mr-2">stars</span>
                        <span class="text-purple-300 font-semibold text-sm">{{header.getCurrentUser().points || 100}}</span>
                    </div>

                    <!-- Simple User Dropdown -->
                    <div class="relative">
                        <button ng-click="header.toggleUserDropdown()"
                                class="flex items-center space-x-2 bg-white/10 hover:bg-purple-500/20 rounded-lg px-3 py-2 transition-all duration-300 border border-white/10 hover:border-purple-500/30">
                            <div class="w-7 h-7 rounded-lg bg-gradient-to-br from-purple-400 to-violet-500 flex items-center justify-center">
                                <span class="material-icons-outlined text-white text-sm">person</span>
                            </div>
                            <span class="hidden sm:block text-white text-sm font-medium truncate max-w-24">
                                {{header.getCurrentUser().email}}
                            </span>
                            <span class="material-icons-outlined text-slate-400 text-sm transition-transform duration-200"
                                  ng-class="{'rotate-180': header.userDropdownOpen}">expand_more</span>
                        </button>

                        <!-- Dropdown Menu -->
                        <div ng-show="header.userDropdownOpen"
                             class="absolute right-0 mt-2 w-52 bg-black/80 backdrop-blur-xl border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/10 py-2 z-50">

                            <!-- User Info -->
                            <div class="px-4 py-3 border-b border-purple-500/20">
                                <div class="text-white text-sm font-medium">{{header.getCurrentUser().email}}</div>
                                <div class="flex items-center text-xs">
                                    <span class="material-icons-outlined text-purple-400 text-xs mr-1">stars</span>
                                    <span class="text-purple-400">{{header.getCurrentUser().points || 100}} points</span>
                                </div>
                            </div>

                            <a ng-click="header.navigateTo('/dashboard'); header.closeUserDropdown()"
                               class="flex items-center px-4 py-2.5 text-sm text-slate-300 hover:text-white hover:bg-purple-500/20 transition-all duration-300 cursor-pointer">
                                <span class="material-icons-outlined text-sm mr-3 text-purple-400">dashboard</span>Dashboard
                            </a>

                            <a ng-click="header.navigateTo('/profile'); header.closeUserDropdown()"
                               class="flex items-center px-4 py-2.5 text-sm text-slate-300 hover:text-white hover:bg-purple-500/20 transition-all duration-300 cursor-pointer">
                                <span class="material-icons-outlined text-sm mr-3 text-purple-400">person</span>Profile
                            </a>

                            <div class="border-t border-purple-500/20 my-2"></div>

                            <a ng-click="header.logout(); header.closeUserDropdown()"
                               class="flex items-center px-4 py-2.5 text-sm text-red-300 hover:text-red-200 hover:bg-red-500/20 transition-all duration-300 cursor-pointer">
                                <span class="material-icons-outlined text-sm mr-3 text-red-400">logout</span>Sign Out
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Guest User -->
                <div ng-if="!header.isAuthenticated()" class="flex items-center space-x-2">
                    <a href="/login"
                       class="px-3 py-2 text-sm font-medium text-slate-400 hover:text-white transition-all duration-300 cursor-pointer">
                        Login
                    </a>
                    <a ng-click="header.navigateTo('/register')"
                       class="px-4 py-2 bg-gradient-to-r from-purple-500 to-violet-600 hover:from-purple-600 hover:to-violet-700 text-white rounded-lg text-sm font-medium transition-all duration-300 cursor-pointer shadow-lg hover:shadow-purple-500/25 transform hover:scale-105">
                        Get Started
                    </a>
                </div>

                <!-- Enhanced Mobile Menu Button -->
                <!-- <button ng-controller="MobileMenuController as mobile"
                        ng-click="mobile.toggle()"
                        class="md:hidden p-2 rounded-lg bg-white/10 hover:bg-purple-500/20 border border-white/10 hover:border-purple-500/30 transition-all duration-300">
                    <span class="material-icons-outlined text-white">{{mobile.isOpen ? 'close' : 'menu'}}</span>
                </button> -->
            </div>
        </div>

    </div>
</header>

<style>
    /* Header specific styles to match the theme */
    header {
        border-bottom: 1px solid rgba(139, 69, 255, 0.2);
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(16px);
    }

    /* Enhanced logo hover effect */
    header .group:hover .bg-gradient-to-br {
        background: linear-gradient(135deg, #a855f7, #7c3aed);
        transform: scale(1.05);
    }

    /* Navigation link animations */
    header nav a {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    header nav a:hover {
        transform: translateY(-1px);
    }

    /* Enhanced dropdown animations */
    header .absolute.right-0 {
        animation: slideDown 0.2s ease-out;
        transform-origin: top right;
    }

    @keyframes slideDown {
        0% {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
        }
        100% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    /* Mobile menu animation */
    header .md\\:hidden.mt-4 {
        animation: slideDown 0.3s ease-out;
    }

    /* Points badge glow effect */
    header .bg-gradient-to-r.from-purple-500\/20 {
        box-shadow: 0 0 20px rgba(139, 69, 255, 0.2);
    }

    /* Enhanced button hover effects */
    header button:hover {
        box-shadow: 0 4px 12px rgba(139, 69, 255, 0.3);
    }

    /* User avatar hover effect */
    header .bg-gradient-to-br.from-purple-400:hover {
        box-shadow: 0 0 15px rgba(139, 69, 255, 0.5);
    }

    /* Mobile navigation enhancements */
    @media (max-width: 768px) {
        header .space-y-1 > a {
            animation: fadeInUp 0.3s ease-out forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        header .space-y-1 > a:nth-child(1) { animation-delay: 0.1s; }
        header .space-y-1 > a:nth-child(2) { animation-delay: 0.2s; }
        header .space-y-1 > a:nth-child(3) { animation-delay: 0.3s; }
        header .space-y-1 > a:nth-child(4) { animation-delay: 0.4s; }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    }

    /* Active link indicator */
    header nav a.bg-purple-500\/20 {
        position: relative;
    }

    header nav a.bg-purple-500\/20::before {
        content: '';
        position: absolute;
        bottom: -4px;
        left: 50%;
        transform: translateX(-50%);
        width: 4px;
        height: 4px;
        background: #a855f7;
        border-radius: 50%;
    }

    /* Improved focus states for accessibility */
    header a:focus,
    header button:focus {
        outline: 2px solid rgba(139, 69, 255, 0.5);
        outline-offset: 2px;
    }

    /* Enhanced glassmorphism */
    header .backdrop-blur-xl {
        backdrop-filter: blur(24px);
    }

    /* Subtle animation for the entire header */
    header {
        animation: slideInDown 0.5s ease-out;
    }

    @keyframes slideInDown {
        0% {
            opacity: 0;
            transform: translateY(-20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>